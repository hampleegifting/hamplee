<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mood Board - Create Your Perfect Hamper | Hamplee</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600;700&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Reusable Navigation Styles -->
    <link rel="stylesheet" href="nav.css">
    
    <!-- Load navigation script early to prevent flicker -->
    <script src="nav.js" defer></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --gold: #C9A959;
            --dark: #1A1A1A;
            --light: #F8F7F4;
            --white: #FFFFFF;
            --grey: #6B6B6B;
            --text: #333333;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: var(--light);
            min-height: 100vh;
            color: var(--text);
        }

        h1, h2, h3 {
            font-family: 'Cormorant Garamond', serif;
            font-weight: 400;
            line-height: 1.2;
        }

        /* Hero Section */
        .hero-section {
            text-align: center;
            padding: 80px 40px 60px;
            background: linear-gradient(135deg, #F8F7F4 0%, #FFFFFF 100%);
            animation: fadeInDown 0.8s ease;
        }

        .hero-badge {
            display: inline-block;
            padding: 8px 24px;
            background: var(--white);
            border: 1px solid var(--gold);
            border-radius: 50px;
            color: var(--gold);
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 24px;
        }

        .hero-section h1 {
            font-size: 42px;
            font-weight: 300;
            color: var(--dark);
            margin-bottom: 20px;
            letter-spacing: 1.5px;
            line-height: 1.3;
        }

        .hero-section p {
            font-size: 16px;
            color: var(--grey);
            max-width: 900px;
            margin: 0 auto;
            letter-spacing: 0.8px;
            line-height: 1.6;
            font-weight: 400;
        }

        /* Progress Bar */
        .progress-container {
            max-width: 900px;
            margin: 60px auto 40px;
            padding: 0 40px;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            position: relative;
        }

        .progress-line {
            position: absolute;
            top: 24px;
            left: 0;
            right: 0;
            height: 2px;
            background: #E0E0E0;
            z-index: 1;
        }

        .progress-line-fill {
            height: 100%;
            background: var(--gold);
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 10px rgba(201, 169, 89, 0.3);
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
            flex: 1;
        }

        .step-circle {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: var(--white);
            border: 2px solid #E0E0E0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--grey);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            margin-bottom: 12px;
            font-family: 'Montserrat', sans-serif;
        }

        .progress-step.active .step-circle {
            background: var(--gold);
            border-color: var(--gold);
            color: var(--white);
            transform: scale(1.1);
            box-shadow: 0 4px 20px rgba(201, 169, 89, 0.4);
        }

        .progress-step.completed .step-circle {
            background: var(--gold);
            border-color: var(--gold);
            color: var(--white);
        }

        .step-label {
            font-size: 13px;
            color: var(--grey);
            font-weight: 500;
            text-align: center;
            transition: color 0.3s ease;
        }

        .progress-step.active .step-label,
        .progress-step.completed .step-label {
            color: var(--gold);
            font-weight: 600;
        }

        /* Form Container */
        .form-container {
            max-width: 900px;
            margin: 0 auto 80px;
            padding: 0 40px;
        }

        .form-card {
            background: var(--white);
            border-radius: 16px;
            padding: 60px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
            position: relative;
        }

        /* Step Content */
        .step-content {
            display: none;
            animation: fadeInRight 0.5s ease;
        }

        .step-content.active {
            display: block;
        }

        .step-title {
            font-size: 42px;
            font-weight: 300;
            color: var(--dark);
            margin-bottom: 12px;
            font-family: 'Cormorant Garamond', serif;
        }

        .step-description {
            font-size: 16px;
            color: var(--grey);
            margin-bottom: 40px;
            line-height: 1.6;
        }

        /* Form Elements */
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 10px;
            letter-spacing: 0.5px;
        }

        label .required {
            color: var(--gold);
            margin-left: 2px;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="number"],
        input[type="date"],
        select,
        textarea {
            width: 100%;
            padding: 16px 20px;
            border: 1px solid #E0E0E0;
            border-radius: 8px;
            font-size: 15px;
            font-family: 'Montserrat', sans-serif;
            color: var(--dark);
            transition: all 0.3s ease;
            background: var(--white);
        }
        
        /* Exclude navigation search from these styles */
        .search-box input[type="text"] {
            width: 250px;
            padding: 10px 75px 10px 16px;
            border: 1px solid #ddd;
            border-radius: 25px;
            font-size: 13px;
        }

        input::placeholder,
        textarea::placeholder {
            color: #AAAAAA;
        }
        
        /* Exclude navigation search from placeholder styles */
        .search-box input::placeholder {
            color: #999;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 0 3px rgba(201, 169, 89, 0.1);
        }
        
        /* Navigation search focus should use its own styles */
        .search-box input:focus {
            border-color: var(--gold);
            box-shadow: 0 0 0 3px rgba(201, 169, 89, 0.1);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
            line-height: 1.6;
        }

        .helper-text {
            font-size: 12px;
            color: var(--grey);
            margin-top: 8px;
            font-style: italic;
            line-height: 1.5;
        }

        /* Budget Cards */
        .budget-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .budget-card {
            position: relative;
        }

        .budget-card input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .budget-label {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 32px 24px;
            background: var(--white);
            border: 2px solid #E0E0E0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .budget-amount {
            font-size: 28px;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 8px;
            font-family: 'Cormorant Garamond', serif;
            transition: color 0.3s ease;
        }

        .budget-desc {
            font-size: 12px;
            color: var(--grey);
            font-weight: 500;
            letter-spacing: 1px;
        }

        .budget-card input[type="radio"]:checked + .budget-label {
            background: linear-gradient(135deg, #FFF9E6 0%, #FFF5D6 100%);
            border-color: var(--gold);
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(201, 169, 89, 0.25);
        }

        .budget-card input[type="radio"]:checked + .budget-label .budget-amount {
            color: var(--gold);
        }

        .budget-label:hover {
            border-color: var(--gold);
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        /* Navigation Buttons */
        .form-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 48px;
            gap: 16px;
        }

        .nav-btn {
            padding: 16px 48px;
            border-radius: 50px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 0.5px;
            border: none;
            font-family: 'Montserrat', sans-serif;
        }

        .btn-prev {
            background: transparent;
            color: var(--grey);
            border: 2px solid #E0E0E0;
        }

        .btn-prev:hover {
            border-color: var(--gold);
            color: var(--gold);
        }

        .btn-next,
        .btn-submit {
            background: var(--gold);
            color: var(--white);
            border: 2px solid var(--gold);
            box-shadow: 0 4px 20px rgba(201, 169, 89, 0.3);
        }

        .btn-next:hover,
        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 30px rgba(201, 169, 89, 0.4);
        }

        .btn-next:active,
        .btn-submit:active {
            transform: translateY(0);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Success Message */
        .success-message {
            display: none;
            text-align: center;
            padding: 80px 40px;
            animation: fadeInUp 0.8s ease;
        }

        .success-message.active {
            display: block;
        }

        .success-animation {
            position: relative;
            width: 120px;
            height: 120px;
            margin: 0 auto 32px;
        }

        .success-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: var(--gold);
            display: flex;
            align-items: center;
            justify-content: center;
            animation: scaleIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 10px 40px rgba(201, 169, 89, 0.4);
        }

        .checkmark {
            width: 50px;
            height: 50px;
            stroke: var(--white);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-dasharray: 100;
            stroke-dashoffset: 100;
            animation: drawCheck 0.6s ease 0.3s forwards;
        }

        .success-message h2 {
            font-size: 48px;
            color: var(--dark);
            margin-bottom: 16px;
            font-weight: 300;
            font-family: 'Cormorant Garamond', serif;
        }

        .success-message p {
            font-size: 16px;
            color: var(--grey);
            margin-bottom: 40px;
            line-height: 1.8;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Animations */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInRight {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes drawCheck {
            to {
                stroke-dashoffset: 0;
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-section {
                padding: 80px 20px 40px;
            }

            .hero-section h1 {
                font-size: 32px;
            }

            .hero-section p {
                font-size: 14px;
            }

            .form-card {
                padding: 40px 30px;
            }

            .form-row,
            .budget-grid {
                grid-template-columns: 1fr;
            }

            .nav-btn {
                padding: 14px 32px;
                font-size: 13px;
            }

            .progress-container {
                padding: 0 20px;
            }

            .step-label {
                font-size: 11px;
            }

            .preference-card {
                flex-direction: column;
                padding: 24px;
            }

            .preference-icon {
                width: 56px;
                height: 56px;
                font-size: 32px;
            }

            .vision-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }

            .vision-icon {
                width: 64px;
                height: 64px;
                font-size: 40px;
            }

            .vision-section {
                padding: 28px;
            }

            .vision-header label {
                font-size: 20px;
            }

            .step-circle {
                width: 40px;
                height: 40px;
                font-size: 14px;
            }

            .step-title {
                font-size: 32px;
            }
        }

        @media (max-width: 480px) {
            .form-navigation {
                flex-direction: column;
            }

            .nav-btn {
                width: 100%;
            }
        }

        /* Product Selector Styles */
        .preference-section {
            display: flex;
            flex-direction: column;
            gap: 24px;
            margin-bottom: 40px;
        }

        .preference-card {
            background: linear-gradient(135deg, #FEFEFE 0%, #F8F7F4 100%);
            border: 2px solid #E8E8E8;
            border-radius: 16px;
            padding: 32px;
            display: flex;
            gap: 24px;
            align-items: flex-start;
            transition: all 0.3s ease;
        }

        .preference-card:hover {
            border-color: var(--gold);
            box-shadow: 0 8px 30px rgba(201, 169, 89, 0.15);
            transform: translateY(-2px);
        }

        .preference-icon {
            font-size: 40px;
            width: 64px;
            height: 64px;
            background: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        .preference-content {
            flex: 1;
        }

        .preference-content label {
            display: block;
            font-size: 18px;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 8px;
            font-family: 'Cormorant Garamond', serif;
        }

        .preference-hint {
            font-size: 13px;
            color: var(--grey);
            margin-bottom: 16px;
            line-height: 1.5;
        }

        .selection-input-wrapper {
            position: relative;
        }

        .selection-display {
            min-height: 50px;
            max-height: 200px;
            padding: 16px 20px;
            background: var(--white);
            border: 2px dashed #D0D0D0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
            overflow-y: auto;
        }

        .selection-display::-webkit-scrollbar {
            width: 6px;
        }

        .selection-display::-webkit-scrollbar-track {
            background: var(--light);
            border-radius: 10px;
        }

        .selection-display::-webkit-scrollbar-thumb {
            background: var(--gold);
            border-radius: 10px;
        }

        .selection-display:hover {
            border-color: var(--gold);
            background: #FFFDF7;
        }

        .selection-display .placeholder {
            color: var(--grey);
            font-size: 14px;
            flex: 1;
        }

        .selection-display .browse-icon {
            color: var(--gold);
            font-size: 20px;
            font-weight: 600;
            transition: transform 0.3s ease;
            flex-shrink: 0;
        }

        .selection-display:hover .browse-icon {
            transform: translateX(4px);
        }

        .selection-display.has-items {
            border-style: solid;
            border-color: var(--gold);
            background: #FFFDF7;
        }

        .vision-section {
            background: linear-gradient(135deg, #FFFDF7 0%, #FFF9E6 100%);
            border: 2px solid var(--gold);
            border-radius: 16px;
            padding: 40px;
            margin-top: 32px;
        }

        .vision-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 24px;
        }

        .vision-icon {
            font-size: 48px;
            width: 72px;
            height: 72px;
            background: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 6px 20px rgba(201, 169, 89, 0.2);
        }

        .vision-header label {
            font-size: 24px;
            font-weight: 600;
            color: var(--dark);
            margin: 0;
            font-family: 'Cormorant Garamond', serif;
        }

        .vision-subtitle {
            font-size: 14px;
            color: var(--grey);
            margin: 8px 0 0 0;
        }

        .vision-section textarea {
            min-height: 180px;
            background: white;
            border: 2px solid var(--gold);
            border-radius: 12px;
        }

        .vision-section textarea:focus {
            border-color: var(--gold);
            box-shadow: 0 0 0 4px rgba(201, 169, 89, 0.1);
        }
            border: 2px solid #ddd;
            border-radius: 12px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: flex-start;
            background: white;
            position: relative;
        }

        .selection-display:hover {
            border-color: var(--gold);
            box-shadow: 0 4px 15px rgba(201, 169, 89, 0.2);
        }

        .selection-display .placeholder {
            color: #999;
            font-size: 15px;
            flex: 1;
        }

        .browse-icon {
            font-size: 20px;
            opacity: 0.6;
        }

        .selected-tag {
            background: var(--gold);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 13px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-weight: 500;
            white-space: nowrap;
            max-width: 300px;
            overflow: hidden;
            text-overflow: ellipsis;
            flex-shrink: 0;
        }

        .remove-tag {
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            opacity: 0.8;
            transition: opacity 0.2s;
        }

        .remove-tag:hover {
            opacity: 1;
        }

        /* Product Selector Modal */
        .product-selector-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 10000;
            backdrop-filter: blur(10px);
            overflow-y: auto;
            padding: 40px 20px;
        }

        .product-selector-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Hide navigation when modal is active */
        body.modal-open nav,
        body.modal-open .announcement-bar {
            display: none !important;
        }

        .product-selector-content {
            background: white;
            border-radius: 20px;
            width: 100%;
            max-width: 1600px;
            max-height: 95vh;
            height: 95vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            animation: modalSlideIn 0.4s ease;
        }

        .product-selector-header {
            padding: 16px 24px;
            border-bottom: 2px solid var(--gold);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .product-selector-header h3 {
            font-size: 20px;
            color: var(--dark);
            margin: 0;
        }

        .close-selector {
            font-size: 28px;
            color: var(--dark);
            background: none;
            border: none;
            cursor: pointer;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-selector:hover {
            background: var(--gold);
            color: white;
            transform: rotate(90deg);
        }

        .product-selector-body {
            flex: 1;
            overflow: hidden;
            padding: 0;
            background: var(--light);
        }

        #productsIframe {
            width: 100%;
            height: 100%;
            min-height: 700px;
            border: none;
        }

        .product-selector-footer {
            padding: 16px 24px;
            border-top: 2px solid var(--light);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        .selector-btn {
            padding: 12px 28px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid var(--gold);
        }

        .btn-cancel {
            background: white;
            color: var(--gold);
        }

        .btn-cancel:hover {
            background: var(--light);
            transform: translateY(-2px);
        }

        .btn-confirm {
            background: var(--gold);
            color: white;
        }

        .btn-confirm:hover {
            background: var(--dark);
            border-color: var(--dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(26, 26, 26, 0.3);
        }

        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 15px;
            }

            .product-selector-header h3 {
                font-size: 22px;
            }

            .selector-categories {
                gap: 8px;
            }

            .category-filter {
                padding: 8px 16px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation placeholder to prevent layout shift -->
    <div class="nav-placeholder"></div>
    
    <!-- Navigation loaded via nav.js -->

    <!-- Hero Section -->
    <div class="hero-section">
        <div class="hero-badge">Bespoke Gifting Experience</div>
        <h1>Mood Board</h1>
        <p>Embark on a journey to create extraordinary gifting experiences. Share your vision, and we'll transform it into reality with meticulous attention to every detail.</p>
    </div>

    <!-- Progress Bar -->
    <div class="progress-container">
        <div class="progress-steps">
            <div class="progress-line">
                <div class="progress-line-fill" id="progressFill" style="width: 25%"></div>
            </div>
            <div class="progress-step active" data-step="1">
                <div class="step-circle">1</div>
                <div class="step-label">Personal</div>
            </div>
            <div class="progress-step" data-step="2">
                <div class="step-circle">2</div>
                <div class="step-label">Event</div>
            </div>
            <div class="progress-step" data-step="3">
                <div class="step-circle">3</div>
                <div class="step-label">Requirements</div>
            </div>
            <div class="progress-step" data-step="4">
                <div class="step-circle">4</div>
                <div class="step-label">Preferences</div>
            </div>
        </div>
    </div>

    <!-- Form Container -->
    <div class="form-container">
        <div class="form-card">
            <form id="moodBoardForm">
                <!-- Step 1: Personal Information -->
                <div class="step-content active" data-step="1">
                    <h2 class="step-title">Personal Information</h2>
                    <p class="step-description">Tell us about yourself so we can tailor our approach to your needs</p>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="name">Full Name <span class="required">*</span></label>
                            <input type="text" id="name" name="name" required placeholder="Enter your full name">
                        </div>
                        <div class="form-group">
                            <label for="email">Email Address <span class="required">*</span></label>
                            <input type="email" id="email" name="email" required placeholder="your.email@company.com">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="contact">Contact Number <span class="required">*</span></label>
                            <input type="tel" id="contact" name="contact" required placeholder="+91 98765 43210">
                        </div>
                        <div class="form-group">
                            <label for="company">Company Name</label>
                            <input type="text" id="company" name="company" placeholder="Your company name">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="designation">Designation</label>
                        <input type="text" id="designation" name="designation" placeholder="Your role or position">
                    </div>
                </div>

                <!-- Step 2: Event Details -->
                <div class="step-content" data-step="2">
                    <h2 class="step-title">Event Details</h2>
                    <p class="step-description">Help us understand the occasion and timeline for your gifting needs</p>
                    
                    <div class="form-group">
                        <label for="event">Event or Initiative</label>
                        <input type="text" id="event" name="event" placeholder="e.g., Diwali Celebration, Employee Recognition, Client Appreciation">
                        <p class="helper-text">What's the occasion or reason for these gifts?</p>
                    </div>
                    <div class="form-group">
                        <label for="eventDate">Event Date</label>
                        <input type="date" id="eventDate" name="eventDate">
                        <p class="helper-text">When is your event taking place?</p>
                    </div>
                </div>

                <!-- Step 3: Order Requirements -->
                <div class="step-content" data-step="3">
                    <h2 class="step-title">Order Requirements</h2>
                    <p class="step-description">Let us know the scale and timeline for your order</p>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="quantity">Expected Quantity <span class="required">*</span></label>
                            <input type="number" id="quantity" name="quantity" required min="1" placeholder="Number of hampers">
                            <p class="helper-text">How many hampers do you need?</p>
                        </div>
                        <div class="form-group">
                            <label for="deliveryDate">Delivery Date <span class="required">*</span></label>
                            <input type="date" id="deliveryDate" name="deliveryDate" required>
                            <p class="helper-text">When do you need them delivered?</p>
                        </div>
                    </div>
                    <div class="form-group full-width">
                        <label>Budget Range per Hamper <span class="required">*</span></label>
                        <div class="budget-grid">
                            <div class="budget-card">
                                <input type="radio" id="budget1" name="budget" value="Below â‚¹1,000" required>
                                <label for="budget1" class="budget-label">
                                    <div class="budget-amount">< â‚¹1K</div>
                                    <div class="budget-desc">VALUE RANGE</div>
                                </label>
                            </div>
                            <div class="budget-card">
                                <input type="radio" id="budget2" name="budget" value="â‚¹1,000 - â‚¹2,000">
                                <label for="budget2" class="budget-label">
                                    <div class="budget-amount">â‚¹1K - â‚¹2K</div>
                                    <div class="budget-desc">PREMIUM RANGE</div>
                                </label>
                            </div>
                            <div class="budget-card">
                                <input type="radio" id="budget3" name="budget" value="â‚¹2,000 - â‚¹3,000">
                                <label for="budget3" class="budget-label">
                                    <div class="budget-amount">â‚¹2K - â‚¹3K</div>
                                    <div class="budget-desc">LUXURY RANGE</div>
                                </label>
                            </div>
                            <div class="budget-card">
                                <input type="radio" id="budget4" name="budget" value="Above â‚¹3,000">
                                <label for="budget4" class="budget-label">
                                    <div class="budget-amount">> â‚¹3K</div>
                                    <div class="budget-desc">ELITE RANGE</div>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Preferences & Vision -->
                <div class="step-content" data-step="4">
                    <h2 class="step-title">Craft Your Perfect Hamper</h2>
                    <p class="step-description">Guide us through your preferences to create a truly personalized gifting experience</p>
                    
                    <!-- Preference Categories -->
                    <div class="preference-section">
                        <div class="preference-card">
                            <div class="preference-icon">ðŸŽ¯</div>
                            <div class="preference-content">
                                <label for="includeItems">Items You'd Love to Include</label>
                                <p class="preference-hint">Select products from our catalog that align with your vision</p>
                                <div class="selection-input-wrapper">
                                    <div class="selection-display" id="includeItemsDisplay" onclick="openProductSelector('include')">
                                        <span class="placeholder">Browse & Select Products</span>
                                        <span class="browse-icon">â†’</span>
                                    </div>
                                    <textarea id="includeItems" name="includeItems" style="display: none;"></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="preference-card">
                            <div class="preference-icon">ðŸ”„</div>
                            <div class="preference-content">
                                <label for="previousItems">Previously Gifted Items</label>
                                <p class="preference-hint">Help us keep your gifts fresh and unique</p>
                                <textarea id="previousItems" name="previousItems" placeholder="List any items or categories you've gifted before that you'd like to avoid repeating..."></textarea>
                            </div>
                        </div>

                        <div class="preference-card">
                            <div class="preference-icon">ðŸš«</div>
                            <div class="preference-content">
                                <label for="excludeItems">Specify any items you'd prefer not to include in the hamper</label>
                                <p class="preference-hint">Let us know what you'd prefer not to include</p>
                                <textarea id="excludeItems" name="excludeItems" placeholder="Any specific items or categories you'd prefer not to include in the hamper..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Vision Statement -->
                    <div class="vision-section">
                        <div class="vision-header">
                            <div class="vision-icon">âœ¨</div>
                            <div>
                                <label for="expectations">Your Vision & Expectations <span class="required">*</span></label>
                                <p class="vision-subtitle">Help us understand the story you want to tell</p>
                            </div>
                        </div>
                        <textarea id="expectations" name="expectations" required placeholder="Share your vision...&#10;&#10;â€¢ What impression do you want to create?&#10;â€¢ What values should the hampers reflect?&#10;â€¢ What emotions should recipients feel?&#10;â€¢ Any specific themes or messages to convey?"></textarea>
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <div class="form-navigation">
                    <button type="button" class="nav-btn btn-prev" id="prevBtn" onclick="changeStep(-1)">Previous</button>
                    <button type="button" class="nav-btn btn-next" id="nextBtn" onclick="changeStep(1)">Next Step</button>
                    <button type="submit" class="nav-btn btn-submit" id="submitBtn" style="display: none;">Submit Your Vision</button>
                </div>
            </form>
        </div>

        <!-- Success Message -->
        <div class="success-message" id="successMessage">
            <div class="form-card">
                <div class="success-animation">
                    <div class="success-circle">
                        <svg class="checkmark" viewBox="0 0 52 52">
                            <path fill="none" d="M14 27l7.8 7.8L38 18"/>
                        </svg>
                    </div>
                </div>
                <h2>Vision Received!</h2>
                <p>Thank you for sharing your vision with us. Our expert team will carefully review your requirements and craft a bespoke proposal that exceeds your expectations. We'll reach out within 24 hours.</p>
                <a href="index.html" class="back-btn">Return to Home</a>
            </div>
        </div>
    </div>

    <script>
        // Multi-step form logic
        let currentStep = 1;
        const totalSteps = 4;

        function showStep(step) {
            // Hide all steps
            document.querySelectorAll('.step-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Show current step
            document.querySelector(`.step-content[data-step="${step}"]`).classList.add('active');
            
            // Update progress
            document.querySelectorAll('.progress-step').forEach((stepEl, index) => {
                stepEl.classList.remove('active', 'completed');
                if (index + 1 < step) {
                    stepEl.classList.add('completed');
                } else if (index + 1 === step) {
                    stepEl.classList.add('active');
                }
            });
            
            // Update progress bar
            const progress = ((step - 1) / (totalSteps - 1)) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            // Update buttons
            document.getElementById('prevBtn').style.display = step === 1 ? 'none' : 'block';
            document.getElementById('nextBtn').style.display = step === totalSteps ? 'none' : 'block';
            document.getElementById('submitBtn').style.display = step === totalSteps ? 'block' : 'none';
        }

        function changeStep(direction) {
            const newStep = currentStep + direction;
            
            if (newStep < 1 || newStep > totalSteps) return;
            
            // Validate current step before moving forward
            if (direction > 0 && !validateStep(currentStep)) {
                return;
            }
            
            currentStep = newStep;
            showStep(currentStep);
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function validateStep(step) {
            const stepContent = document.querySelector(`.step-content[data-step="${step}"]`);
            const requiredFields = stepContent.querySelectorAll('[required]');
            
            for (let field of requiredFields) {
                if (!field.value.trim()) {
                    field.focus();
                    field.style.borderColor = '#ff6b6b';
                    setTimeout(() => {
                        field.style.borderColor = '';
                    }, 2000);
                    return false;
                }
            }
            return true;
        }

        // Form submission
        document.getElementById('moodBoardForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!validateStep(totalSteps)) {
                return;
            }
            
            const formData = new FormData(this);
            const data = Object.fromEntries(formData);
            
            // Add wishlist items if coming from skip mode
            const urlParams = new URLSearchParams(window.location.search);
            const skipToVision = urlParams.get('skip') === 'true';
            
            if (skipToVision) {
                const wishlistItems = JSON.parse(localStorage.getItem('likedWishlist') || '[]');
                const itemNames = wishlistItems.map(item => item.name).join(', ');
                data.includeItems = itemNames;
            }
            
            // Show loading state
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.textContent = 'Submitting...';
            submitBtn.disabled = true;
            
            // Google Sheets endpoint
            const scriptURL = "https://script.google.com/macros/s/AKfycbyeQLC4-A85U9YFrvYQH_jSAdAMqyDapEQJyGChJ_9bIjqy_TxPIaAuBOUH6FUpiwIYnQ/exec";
            
            // Prepare data as labeled pipe-separated string
            const dataString = [
                `Name: ${data.name || 'N/A'}`,
                `Email: ${data.email || 'N/A'}`,
                `Contact: ${data.contact || 'N/A'}`,
                `Company: ${data.company || 'N/A'}`,
                `Designation: ${data.designation || 'N/A'}`,
                `Event/Initiative: ${data.event || 'N/A'}`,
                `Event Date: ${data.eventDate || 'N/A'}`,
                `Quantity: ${data.quantity || 'N/A'}`,
                `Delivery Date: ${data.deliveryDate || 'N/A'}`,
                `Budget: ${data.budget || 'N/A'}`,
                `Previously Gifted: ${data.previousItems || 'N/A'}`,
                `Items to Include: ${data.includeItems || 'N/A'}`,
                `Items to Exclude: ${data.excludeItems || 'N/A'}`,
                `Expectations: ${data.expectations || 'N/A'}`
            ].join(' | ');
            
            // Log for debugging
            console.log('Sending data:', dataString);
            
            const formParams = new URLSearchParams();
            formParams.append('address', 'MOOD_BOARD');
            formParams.append('contact', dataString);
            
            // Submit to Google Sheets
            fetch(scriptURL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: formParams.toString()
            })
            .then(response => response.text())
            .then(responseText => {
                console.log('Success:', responseText);
                
                // Hide form and show success
                document.querySelector('.form-card').style.display = 'none';
                document.getElementById('successMessage').classList.add('active');
                document.querySelector('.progress-container').style.display = 'none';
                
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                // Reset form
                this.reset();
                submitBtn.textContent = 'Submit Your Vision';
                submitBtn.disabled = false;
                currentStep = 1;
            })
            .catch(error => {
                console.error('Error:', error);
                alert('There was an error submitting your form. Please try again or contact us directly.');
                
                // Reset button
                submitBtn.textContent = 'Submit Your Vision';
                submitBtn.disabled = false;
            });
        });

        // Set minimum dates
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('deliveryDate').setAttribute('min', today);
        document.getElementById('eventDate').setAttribute('min', today);

        // Check if coming from wishlist
        const urlParams = new URLSearchParams(window.location.search);
        const skipToVision = urlParams.get('skip') === 'true';
        
        if (skipToVision) {
            // Hide the first 3 preference cards (Items to Include, Previously Gifted, Items to Exclude)
            const preferenceCards = document.querySelectorAll('.preference-card');
            if (preferenceCards.length >= 3) {
                preferenceCards[0].style.display = 'none'; // Items to Include
                preferenceCards[1].style.display = 'none'; // Previously Gifted
                preferenceCards[2].style.display = 'none'; // Items to Exclude
            }
        }
        
        // Initialize - always start at step 1
        showStep(1);
        
        // Populate Items to Include from Liked Wishlist
        populateFromLikedWishlist();
    </script>

    <script>
        // Populate Items to Include from Liked Wishlist
        function populateFromLikedWishlist() {
            const likedItems = JSON.parse(localStorage.getItem('likedWishlist') || '[]');
            
            if (likedItems.length > 0) {
                // Filter only products (not hampers)
                const products = likedItems.filter(item => item.type !== 'hamper');
                
                if (products.length > 0) {
                    // Convert to our selection format
                    selectedProducts.include = products.map(item => ({
                        id: item.id,
                        name: item.name,
                        category: item.category || 'Product'
                    }));
                    
                    // Update the display
                    const display = document.getElementById('includeItemsDisplay');
                    const textarea = document.getElementById('includeItems');
                    
                    display.innerHTML = selectedProducts.include.map(product => 
                        `<span class="selected-tag">${product.name} <span class="remove-tag" onclick="removeItem(event, 'include', '${product.id}')">Ã—</span></span>`
                    ).join('');
                    
                    textarea.value = selectedProducts.include.map(p => p.name).join(', ');
                    
                    // Show notification
                    showLikedWishlistNotification(products.length);
                }
            }
        }
        
        function showLikedWishlistNotification(count) {
            // Create a subtle notification
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                bottom: 30px;
                right: 30px;
                background: var(--gold);
                color: white;
                padding: 16px 24px;
                border-radius: 12px;
                box-shadow: 0 8px 30px rgba(201, 169, 89, 0.4);
                z-index: 10000;
                font-weight: 600;
                font-size: 15px;
                animation: slideInUp 0.4s ease;
            `;
            notification.textContent = `âœ“ ${count} item${count !== 1 ? 's' : ''} from your Liked Wishlist added to preferences`;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutDown 0.4s ease';
                setTimeout(() => notification.remove(), 400);
            }, 3000);
        }
    </script>

    <!-- Product Selector Modal -->
    <div class="product-selector-modal" id="productSelectorModal">
        <div class="product-selector-content">
            <div class="product-selector-header">
                <h3 id="selectorTitle">Select Products to Include</h3>
                <button class="close-selector" onclick="closeProductSelector()">&times;</button>
            </div>
            
            <div class="product-selector-body">
                <iframe id="productsIframe" src="" frameborder="0"></iframe>
            </div>
            
            <div class="product-selector-footer">
                <button class="selector-btn btn-cancel" onclick="closeProductSelector()">Cancel</button>
                <button class="selector-btn btn-confirm" onclick="confirmSelection()">Confirm Selection</button>
            </div>
        </div>
    </div>

    <script>
        // Product Selection Logic
        let currentSelectionType = 'include'; // 'include' or 'exclude'
        let selectedProducts = {
            include: [],
            exclude: []
        };

        function openProductSelector(type) {
            currentSelectionType = type;
            const modal = document.getElementById('productSelectorModal');
            const title = document.getElementById('selectorTitle');
            const iframe = document.getElementById('productsIframe');
            
            title.textContent = type === 'include' 
                ? 'Browse & Select Products to Include' 
                : 'Browse & Select Products to Exclude';
            
            // If opening "include" and wishlist items are already loaded, ensure they're in selectedProducts
            if (type === 'include' && !selectedProducts.include.length) {
                const likedItems = JSON.parse(localStorage.getItem('likedWishlist') || '[]');
                const products = likedItems.filter(item => item.type !== 'hamper');
                
                if (products.length > 0) {
                    selectedProducts.include = products.map(item => ({
                        id: item.id,
                        name: item.name,
                        category: item.category || 'Product'
                    }));
                }
            }
            
            // Add modal-open class to body
            document.body.classList.add('modal-open');
            
            // Load products page with selection mode
            iframe.src = `products.html?mode=selection&type=${type}`;
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeProductSelector() {
            const modal = document.getElementById('productSelectorModal');
            const iframe = document.getElementById('productsIframe');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
            iframe.src = '';
            
            // Remove modal-open class from body
            document.body.classList.remove('modal-open');
        }

        // Listen for messages from iframe
        window.addEventListener('message', function(event) {
            console.log('Received message:', event.data);
            
            if (event.data.type === 'productSelection') {
                // Only update if products array is defined (not undefined or null)
                if (event.data.products !== undefined) {
                    selectedProducts[currentSelectionType] = event.data.products;
                    console.log('Updated selectedProducts:', selectedProducts);
                }
            }
            
            // Handle wishlist update from iframe
            if (event.data.type === 'wishlistUpdate') {
                console.log('Wishlist updated, new count:', event.data.count);
                
                // Update the wishlist counter
                if (typeof updateWishlistCount === 'function') {
                    updateWishlistCount();
                } else if (typeof window.updateWishlistCount === 'function') {
                    window.updateWishlistCount();
                } else if (typeof updateLikedWishlistCount === 'function') {
                    updateLikedWishlistCount();
                } else if (typeof window.updateLikedWishlistCount === 'function') {
                    window.updateLikedWishlistCount();
                }
            }
        });

        function confirmSelection() {
            const products = selectedProducts[currentSelectionType];
            console.log('Confirming selection:', products);
            const displayId = currentSelectionType + 'ItemsDisplay';
            const textareaId = currentSelectionType + 'Items';
            
            const display = document.getElementById(displayId);
            const textarea = document.getElementById(textareaId);
            
            if (products && products.length > 0) {
                // Clear the placeholder and add selected tags
                display.innerHTML = '';
                display.classList.add('has-items');
                
                products.forEach(product => {
                    const tag = document.createElement('span');
                    tag.className = 'selected-tag';
                    tag.innerHTML = `${product.name} <span class="remove-tag" onclick="removeItem(event, '${currentSelectionType}', '${product.id}')">Ã—</span>`;
                    display.appendChild(tag);
                });
                
                textarea.value = products.map(p => p.name).join(', ');
            } else {
                display.classList.remove('has-items');
                display.innerHTML = '<span class="placeholder">Browse & Select Products</span><span class="browse-icon">â†’</span>';
                textarea.value = '';
            }
            
            closeProductSelector();
        }

        function removeItem(event, type, productId) {
            event.stopPropagation();
            
            const index = selectedProducts[type].findIndex(p => p.id == productId);
            if (index > -1) {
                selectedProducts[type].splice(index, 1);
            }
            
            // Update display
            currentSelectionType = type;
            confirmSelection();
        }
    </script>
</body>
</html>
